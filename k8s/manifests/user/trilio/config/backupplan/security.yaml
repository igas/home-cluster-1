---
apiVersion: triliovault.trilio.io/v1
kind: BackupPlan
metadata:
  name: security
  namespace: security
spec:
  backupConfig:
    retentionPolicy:
      apiVersion: triliovault.trilio.io/v1
      kind: Policy
      name: retention
      namespace: security

    schedulePolicy:
      fullBackupPolicy:
        apiVersion: triliovault.trilio.io/v1
        kind: Policy
        name: weekly-schedule
        namespace: security

      incrementalBackupPolicy:
        apiVersion: triliovault.trilio.io/v1
        kind: Policy
        name: daily-schedule
        namespace: security

    target:
      apiVersion: triliovault.trilio.io/v1
      kind: Target
      name: hyperion
      namespace: security

  excludeResources:
    labelSelector:
      - matchExpressions:
          - key: "triliovault.trilio.io/backup"
            operator: "DoesNotExist"

  includeResources:
    labelSelector:
      - matchLabels:
          triliovault.trilio.io/backup: "true"
