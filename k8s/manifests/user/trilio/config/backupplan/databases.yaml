---
apiVersion: triliovault.trilio.io/v1
kind: BackupPlan
metadata:
  name: databases
  namespace: databases
spec:
  backupConfig:
    retentionPolicy:
      apiVersion: triliovault.trilio.io/v1
      kind: Policy
      name: retention
      namespace: databases

    schedulePolicy:
      fullBackupPolicy:
        apiVersion: triliovault.trilio.io/v1
        kind: Policy
        name: weekly-schedule
        namespace: databases

      incrementalBackupPolicy:
        apiVersion: triliovault.trilio.io/v1
        kind: Policy
        name: daily-schedule
        namespace: databases

    target:
      apiVersion: triliovault.trilio.io/v1
      kind: Target
      name: hyperion
      namespace: databases

  excludeResources:
    labelSelector:
      - matchExpressions:
          - key: "triliovault.trilio.io/backup"
            operator: "DoesNotExist"

  includeResources:
    labelSelector:
      - matchLabels:
          triliovault.trilio.io/backup: "true"
