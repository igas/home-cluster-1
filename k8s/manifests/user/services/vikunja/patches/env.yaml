---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: vikunja
  namespace: services
spec:
  values:
    additionalContainers:
      - name: api
        env:
          - name: VIKUNJA_DATABASE_TYPE
            value: "postgres"
          - name: VIKUNJA_DATABASE_HOST
            value: postgres-rw.databases.svc.cluster.local.
          - name: VIKUNJA_DATABASE_DATABASE
            value: vikunja
          - name: VIKUNJA_DATABASE_USER
            value: vikunja
          - name: VIKUNJA_DATABASE_PASSWORD
            value: ${SECRET_VIKUNJA_POSTGRES_PASSWORD}
          - name: VIKUNJA_SERVICE_FRONTENDURL
            value: https://tasks.${SECRET_DOMAIN}
          - name: VIKUNJA_MAILER_FROMEMAIL
            value: tasks@${EMAIL_DOMAIN}
          - name: VIKUNJA_MAILER_ENABLED
            value: "true"
          - name: VIKUNJA_MAILER_HOST
            value: smtp-relay.services.svc.cluster.local
          - name: VIKUNJA_MAILER_PORT
            value: "2525"
