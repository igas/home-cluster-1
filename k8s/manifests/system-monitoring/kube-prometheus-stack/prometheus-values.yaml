---
prometheus:
  ingress:
    enabled: true
    pathType: Prefix
    annotations:
      kubernetes.io/ingress.class: traefik
      cert-manager.io/cluster-issuer: ${CLUSTER_CERT}
      external-dns.alpha.kubernetes.io/target: ipv4.${CLUSTER_DOMAIN}
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
      traefik.ingress.kubernetes.io/router.middlewares: network-system-rfc1918-ips@kubernetescrd
      monitor.stakater.com/enabled: "true"
      hajimari.io/enable: "true"
      hajimari.io/icon: database-clock
      hajimari.io/appName: Prometheus

    hosts:
      - prometheus.${CLUSTER_NAME}.${CLUSTER_DOMAIN}
    tls:
      - secretName: prometheus-${CLUSTER_NAME}-tls
        hosts:
          - prometheus.${CLUSTER_NAME}.${CLUSTER_DOMAIN}

  thanosService:
    enabled: false

  prometheusSpec:
    replicas: 1
    replicaExternalLabelName: "replica"
    ruleSelectorNilUsesHelmValues: false
    serviceMonitorSelectorNilUsesHelmValues: false
    podMonitorSelectorNilUsesHelmValues: false
    probeSelectorNilUsesHelmValues: false
    retention: 6h
    enableAdminAPI: true
    walCompression: true
    # storageSpec:
    #   volumeClaimTemplate:
    #     spec:
    #       storageClassName: ceph-block
    #       resources:
    #         requests:
    #           storage: 10Gi
    additionalScrapeConfigs:
      - job_name: node-exporter
        honor_timestamps: true
        metrics_path: /metrics
        static_configs:
          - targets:
              - ${NAS_ADDRESS}:9100

    resources:
      requests:
        memory: 3072Mi
      limits:
        memory: 4096Mi

    # thanos:
    #   image: quay.io/thanos/thanos:v0.23.1
    #   version: v0.22.0
    #   objectStorageConfig:
    #     name: thanos-objstore-secret
    #     key: objstore.yml
