---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: pleroma-rebased
  namespace: services
spec:
  values:
    additionalContainers:
      frontend:
        name: git-sync
        image: willdockerhub/git-sync:v3.3.0
        imagePullPolicy: IfNotPresent
        args:
          - '--repo=https://gitlab.com/soapbox-pub/soapbox.git'
          - '--branch=develop'
          - '--depth=1'
          - '--root=/static-git'
          - '--link=/static'
          - '--wait=21600' # 6 hours

        volumeMounts:
          - name: static
            mountPath: /static
          - name: static-git
            mountPath: /static-git
